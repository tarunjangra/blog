<!DOCTYPE html> <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US" itemscope="" itemtype="http://schema.org/WebPage"> <head> <meta charset="utf-8"/> <meta itemprop="name" content="How to create custom amazon AMI throught CLI Commands" /> <meta itemprop="author" content="Tarun Jangra" /> <meta itemprop="breadcrumb" content="http://tarunjangra.com" /> <meta itemprop="keywords" content="" /> <meta itemprop="description" content="Here i will put together some command which will help you to create your custom AMI to be used for your custom requirement. " /> <meta name="description" content="Here i will put together some command which will help you to create your custom AMI to be used for your custom requirement. " /> <meta name="keywords" content="" /> <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1"/> <meta name="twitter:creator" content="@jangratarun"/> <meta name="google-site-verification" content="LbBZQggzMfCTynN2RhklpF6XLElwBM85RK044iJnmTA" /> <meta property="twitter:account_id" content="363229840" /> <meta property="og:url" content="http://tarunjangra.com/2011/05/11/how-to-create-custome-amazon-AMI.html"/> <meta property="og:site_name" content="Tarun Jangra's Blog'"/> <meta property="og:title" content="How to create custom amazon AMI throught CLI Commands"/> <meta property="og:description" content="Here i will put together some command which will help you to create your custom AMI to be used for your custom requirement. "/> <meta property="og:type" content="article" /> <meta property="og:locale" content="en_US" /> <meta property="fb:admins" content="1032543096808130"/> <meta name="twitter:site" content="@jangratarun"/> <meta name="twitter:creator" content="@jangratarun"/> <meta name="twitter:url" content="http://tarunjangra.com/2011/05/11/how-to-create-custome-amazon-AMI.html"/> <meta property="article:author" content="https://www.facebook.com/jangra.tarun"/> <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="tarunjangra" /> <link rel="shortcut icon" href="/favicon.ico?e19bdad"/> <link rel="apple-touch-icon" href="/favicon.ico?e19bdad"/> <link rel="alternate" type="application/rss+xml" title="RSS for tarunjangra.com" href="http://tarunjangra.com/rss.xml"/> <link rel="author" href="https://plus.google.com/u/0/+TarunJangras?rel=author" /> <link rel="publisher" href="https://plus.google.com/u/0/+TarunJangras" /> <link rel="stylesheet" href="/css/layout.css?e19bdad"/> <link rel="stylesheet" href="/css/icons.css?e19bdad"/> <link rel="canonical" href="http://tarunjangra.com/2011/05/11/how-to-create-custome-amazon-AMI.html" /> <link rel="amphtml" href="http://tarunjangra.com/2011/05/11/how-to-create-custome-amazon-AMI.amp.html" /> <title>How to create custom amazon AMI throught CLI Commands - Tarun Jangra </title> <body><div class="wrapper"> <aside class="header-toggle unprintable" id="header-toggle" title="show head menu" onclick="$('#header').show();$('#header-toggle').hide();">&#9776;</aside> <header class="header" id="header"><div class="face"> <a href="/about-me.html#form" class="sub"><span>subscribe</span></a> <a href="/about-me.html"> <img src="/images/about/tarun-jangra-200x200.jpg" class="photo" alt="photo of Tarun Jangra"/> </a></div><nav><ul class="menu social notranslate"> <li><a href="http://www.twitter.com/jangratarun" title="follow me in Twitter"><i class="icon icon-twitter notranslate" aria-hidden="true"></i></a> <li><a href="/rss" title="RSS feed"><i class="icon icon-rss notranslate" aria-hidden="true"></i></a> <li><a href="https://github.com/tarunjangra" title="my GitHub profile"><i class="icon icon-github notranslate" aria-hidden="true"></i></a> <li><a href="https://www.facebook.com/jangra.tarun" title="follow me in Facebook"><i class="icon icon-facebook notranslate" aria-hidden="true"></i></a> <li><a href="https://instagram.com/tarunjangra" title="follow me in Instagram"><i class="icon icon-instagram notranslate" aria-hidden="true"></i></a> <li><a href="https://www.linkedin.com/in/tarunjangra" title="my LinkedIn profile"><i class="icon icon-linkedin notranslate" aria-hidden="true"></i></a> <li><a href="https://www.youtube.com/channel/UC0ZsPdSN8ZfQBTGrpD2I7-A" title="my Youtube video channel"><i class="icon icon-youtube notranslate" aria-hidden="true"></i></a> <li><a href="https://angel.co/tarunjangra" title="my AngelList profile"><i class="icon icon-angellist notranslate" aria-hidden="true"></i></a> <li><a href="mailto:blog@tarunjangra.com" title="blog@tarunjangra.com"><i class="icon icon-mail notranslate" aria-hidden="true"></i></a></ul><ul class="menu"> <li><a href="/" title="Home page">Home</a> <li><a href="/contents.html" title="blog contents">all&#160;25</a></ul></nav><div id="search"> <form method="get" action="https://www.google.com/search" style="position:relative"> <input name="sitesearch" value="tarunjangra.com" type="hidden"/> <input id="search-query" class="field field-text" onfocus="$('#google').css('display', 'inline-block');" name="q" placeholder="Search" autocomplete="off"/> <span class="desktop-only"> <input type="image" src="/images/google-search-icon.svg" id="google" title="search via Google" style="height:2.4em;display:none;position:absolute;top:.3em;margin-left:1em;" alt="search via Google"/> </span> </form><div id="search-results" style="display: none;"><div class="entries"></div></div></div><div class="hot"><ul> <li> Join my new chatroom on Gitter to discuss about cloud computing in realtime: <a href="https://gitter.im/tarunjangra/codepipe">tarunjangra/codepipe</a>!</ul></div></header></div><section itemscope="" itemtype="http://schema.org/BlogPosting"><div class="wrapper"> <header><p class="printable"> <img src="https://api.qrserver.com/v1/create-qr-code/?data=http://tarunjangra.com/2011/05/11/how-to-create-custome-amazon-AMI.html&amp;format=svg" style="width:125px;height:125px;" alt="QR code"/><p class="printable"> <code>http://tarunjangra.com/2011/05/11/how-to-create-custome-amazon-AMI.html</code><h1 itemprop="name">How to create custom amazon AMI throught CLI Commands</h1><ul class="subline"> <li> <time itemprop="datePublished" datetime="2011-05-11T00:00:00+00:00"> 11 May 2011 </time> <li class='unprintable desktop-only'><a href='https://github.com/tarunjangra/blog/commits/master/_posts/2011/may/2011-05-11-how-to-create-custome-amazon-AMI.md'>modified</a> on <time itemprop='dateModified' datetime='2016-12-12T00:26:29+0530'>12 December 2016</time> <li class="printable">Tarun Jangra <li class="unprintable"> <i class="icon icon-comments"></i> <a href="http://tarunjangra.com/2011/05/11/how-to-create-custome-amazon-AMI.html#disqus_thread" itemprop="discussionUrl">comments</a></ul><p class="unprintable"><a href='/tag/AMI.html' class='tag notranslate'>AMI</a> <a href='/tag/AWS.html' class='tag notranslate'>AWS</a> <a href='/tag/Amazon.html' class='tag notranslate'>Amazon</a> <a href='/tag/CLI.html' class='tag notranslate'>CLI</a><div class="buttons notranslate desktop-only"> <nav class="share" role="navigation"> <a href="http://www.facebook.com/sharer/sharer.php?u=http://tarunjangra.com/2011/05/11/how-to-create-custome-amazon-AMI.html" title="Share on Facebook" class="button"> <span class="count count-facebook">0</span> <i class="icon icon-facebook notranslate" aria-hidden="true"></i> </a> <a href="https://twitter.com/share?url=http://tarunjangra.com/2011/05/11/how-to-create-custome-amazon-AMI.html&amp;text=How+to+create+custom+amazon+AMI+throught+CLI+Commands" title="Share on Twitter" class="button"> <span class="count count-twitter">0</span> <i class="icon icon-twitter notranslate" aria-hidden="true"></i> </a> <a href="https://plus.google.com/share?url=http://tarunjangra.com/2011/05/11/how-to-create-custome-amazon-AMI.html" title="Share on Google+" class="button"> <span class="count count-googleplus">0</span> <i class="icon icon-googleplus notranslate" aria-hidden="true"></i> </a> <a href="https://www.linkedin.com/cws/share?url=http://tarunjangra.com/2011/05/11/how-to-create-custome-amazon-AMI.html" title="Share on LinkedIn" class="button"> <span class="count count-linkedin">0</span> <i class="icon icon-linkedin notranslate" aria-hidden="true"></i> </a> <a href="http://www.stumbleupon.com/submit?url=http://tarunjangra.com/2011/05/11/how-to-create-custome-amazon-AMI.html&amp;title=How+to+create+custom+amazon+AMI+throught+CLI+Commands" title="Share on StumbleUpon" class="button"> <span class="count count-stumbleupon">0</span> <i class="icon icon-stumbleupon notranslate" aria-hidden="true"></i> </a> <a href="http://reddit.com/submit?url=http://tarunjangra.com/2011/05/11/how-to-create-custome-amazon-AMI.html%3F2011-19&amp;title=How+to+create+custom+amazon+AMI+throught+CLI+Commands" title="Share on Reddit" class="button"> <span class="count count-reddit">0</span> <i class="icon icon-reddit notranslate" aria-hidden="true"></i> </a> <a href="http://news.ycombinator.com/submitlink?u=http://tarunjangra.com/2011/05/11/how-to-create-custome-amazon-AMI.html%3F2011-19&amp;t=How+to+create+custom+amazon+AMI+throught+CLI+Commands" title="Share on Hacker News" class="button"> <i class="icon icon-hackernews notranslate" aria-hidden="true"></i> </a> </nav></div></header> <main> <article class="main" itemprop="articleBody"><p>Today, i am going to explain how you can create custom amazon ami to launch instance anytime later. This will have you clone of your server anytime you need. I am considering you are able to login your current running instance and you also have your private key and certificate downloaded on some location.<p><img src="http://tarunjangra.com/images/assets/ami_lifecycle.png" alt="Aamazon AMI"><p>Upload your private key and certificate on the running instance. <figure class="highlight"><pre><code class="language-bash" data-lang="bash">scp -i path/of/yourkeypair.pem path/of/cert.pem /mnt
scp -i path/of/yourkeypair.pem path/of/pk.pem /mnt</code></pre></figure><p>Login to your instance and check if uploaded files are available in /mnt. <figure class="highlight"><pre><code class="language-bash" data-lang="bash">ec2-bundle-vol 
-d /mnt -k /mnt/pk.pem 
-c /mnt/cert.pem 
-u <span class="m">673491274719</span> 
-p name-of-ami</code></pre></figure><p>This will take some time and create the desired ami to be uploaded in the bucket. So you can use that later anytime you need. Now upload your bundle to amazon s3 storage. <figure class="highlight"><pre><code class="language-bash" data-lang="bash">ec2-upload-bundle 
-b &lt;S3-bucket-name&gt; 
-m /mnt/name-of-ami.manifest.xml 
-a &lt;AWS-access-key-id&gt; 
-s  &lt;AWS-secret-access-key&gt; 
--location US-EAST-1C</code></pre></figure><p>Note: Remember to upload to an S3 bucket in correct region. Also: if the bucket does not exit, it will be created for you. (I’ve used a European bucket as an example.) Now we need to register AMI. Do following&lt; br /&gt; <figure class="highlight"><pre><code class="language-bash" data-lang="bash">ec2-register &lt;bucket-name&gt;/sampleimage.manifest.xml --region US-EAST-1C</code></pre></figure><p>It will return the new AMI ID (like ami-). That’s it you are done with your custom ami. </article> </main> 
  <div class="unprintable">
    <h2>Related Posts</h2>
    <p>You may also find these posts interesting:</p>
    <ul>
      
        <li>
          <a href="/2014/07/11/elasticSearch-restore-failed-when-s3-gateway-activated.html" data-score="2.218670426661187">ElasticSearch restore failed when s3-gateway is activated</a>
        </li>
      
        <li>
          <a href="/2012/12/29/how-to-install-godaddy-ssl-on-ELB.html" data-score="1.8015368155656237">How to install go-daddy ssl certificate on amazon load balancer</a>
        </li>
      
        <li>
          <a href="/2016/03/02/amazon-ec2.html" data-score="0.27432110130007464">Amazon Elastic Cloud Computing (EC2)</a>
        </li>
      
        <li>
          <a href="/2016/12/19/serving-authenticated-static-content.html" data-score="0.14628474222080146">Serving Authenticated Static Content was pretty expensive before today</a>
        </li>
      
    </ul>
  </div>

<div class="teamed-banner"> <a href="http://www.abcdevops.com"> <img src="/images/banners/abcdevops.png" alt="banner"/> </a></div></div><div class="disqus" role="complementary"><div id="disqus_thread" class="disqus-thread"></div><script> var disqus_config = function () { this.page.url = document.location.href.split('?')[0].split('#')[0]; this.page.identifier = this.page.url; }; (function() { var d = document, s = d.createElement('script'); s.src = '//wwwtarunjangracom.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> <noscript><div><p class="red"> JavaScript is disabled in your browser, that's why you can't see comments under this post.</div></noscript></div><div class="wrapper"> <footer class="footer"><p> &copy; <span itemprop="author">Tarun Jangra</span>, 2016 </footer></div></section> <script src="//code.jquery.com/jquery-1.9.0.min.js"></script> <script src="/js/all.js?e19bdad"></script> <script>var disqus_shortname = 'wwwtarunjangracom';</script> <script id="dsq-count-scr" src="//wwwtarunjangracom.disqus.com/count.js" async="async"></script> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-783273-5', 'auto'); ga('send', 'pageview'); </script> <script language="javascript" type="text/javascript"> Cd=document;Cr="&"+Math.random();Cp="&s=1"; Cd.cookie="b=b";if(Cd.cookie)Cp+="&c=1"; Cp+="&t="+(new Date()).getTimezoneOffset(); if(self!=top)Cp+="&f=1"; </script> <script language="javascript1.1" type="text/javascript"> if(navigator.javaEnabled())Cp+="&j=1"; </script> <script language="javascript1.2" type="text/javascript"> if(typeof(screen)!='undefined')Cp+="&w="+screen.width+"&h="+ screen.height+"&d="+(screen.colorDepth?screen.colorDepth:screen.pixelDepth); </script> <script language="javascript" type="text/javascript"> Cd.write("<img src='//c.hit.ua/hit?i=95870&g=0&x=2"+Cp+Cr+ "&r="+escape(Cd.referrer)+"&u="+escape(window.location.href)+ "' border='0' wi"+"dth='1' he"+"ight='1'/>"); </script>
